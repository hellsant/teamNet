var module=angular.module("ui.select",[]);module.value("customSelectDefaults",{displayText:"Select an element...",emptyListText:"There are no items to display",emptySearchResultText:'No results match "$0"',addText:"Add",searchDelay:1e3});module.directive("customSelect",["$parse","$compile","$timeout","customSelectDefaults",function(e,t,n,r){var i=/^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(.*?)(?:\s+track\s+by\s+(.*?))?$/;return{restrict:"A",require:"ngModel",link:function(s,o,u,a){function M(){var e,t={},n=undefined,r=N.val();if(r&&r!=="?"){e=d(O)||[];t[c]=e[r];n=l(O,t)}O.displayText=n||v.displayText}function _(){return angular.extend({},r,s.$eval(u.customSelect))}function D(){v=_();return v.displayText}function P(){var e=A.find("li > a");if(e.length>0){w=0;e.eq(0).focus()}}function H(){var e=A.find("li > a");if(e.length>0){var t=e.eq(0).scope();var n=t[c];O.$apply(function(){O.select(n)});k.dropdown("toggle")}}function B(){O.addText=v.addText;O.emptySearchResultText=v.emptySearchResultText;O.emptyListText=v.emptyListText;O.select=function(e){var t={};t[c]=e;var n=h(O,t);O.displayText=l(O,t)||v.displayText;a.$setViewValue(n);O.search=E();k.focus();typeof v.onSelect==="function"&&v.onSelect(e)};O.add=function(){v.onAdd(O.select)};if(g){L.attr("ng-change","onSearch("+m+")");O.onSearch=function(e){if(y){y=n.cancel(y)}e=(e||"").trim();y=n(function(){y=n.cancel(y);if(e!=b){v.onSearch(b=e)}},e&&v.searchDelay||0)}}M()}if(!u.ngOptions){throw new Error("Expected ng-options attribute.")}var f=u.ngOptions.match(i);if(!f){throw new Error("Expected expression in form of "+"'_select_ (as _label_)? for (_key_,)?_value_ in _collection_'"+" but got '"+u.ngOptions+"'.")}o.addClass("dropdown custom-select");var l=e(f[2]||f[1]),c=f[4]||f[6],h=e(f[2]?f[1]:c),p=f[7],d=e(p);var v=_(),m=f[2]?f[2].replace(new RegExp("^"+c+"\\."),"search."):"search",g=typeof v.onSearch==="function",y,b="",w=-1,E=function(){return f[2]?{}:""};var S=o.html().trim()||"{{"+(f[2]||f[1])+"}}",x='<select class="hide" ng-options="'+u.ngOptions+'" ng-model="'+u.ngModel+'" '+(u.ngChange?'ng-change="'+u.ngChange+'"':"")+"></select>",T='<a class="dropdown-toggle" data-toggle="dropdown" href ng-class="{ disabled: disabled }">'+"<span>{{displayText}}</span>"+"<b></b>"+"</a>"+'<div class="dropdown-menu">'+'<div stop-propagation="click" class="custom-select-search">'+'<input class="'+u.selectClass+'" type="text" autocomplete="off" ng-model="'+m+'" />'+"</div>"+'<ul role="menu">'+'<li role="presentation" ng-repeat="'+c+" in "+p+(g?"":" | filter: search")+'">'+'<a role="menuitem" tabindex="-1" href ng-click="select('+c+')">'+S+"</a>"+"</li>"+'<li ng-hide="('+p+(g?"":" | filter: search")+').length" class="empty-result" stop-propagation="click">'+'<em class="muted">'+'<span ng-hide="'+m+'">{{emptyListText}}</span>'+'<span class="word-break" ng-show="'+m+'">{{emptySearchResultText | format:'+m+"}}</span>"+"</em>"+"</li>"+"</ul>"+'<div class="custom-select-action">'+(typeof v.onAdd==="function"?'<button type="button" class="btn btn-primary btn-block add-button" ng-click="add()">{{addText}}</button>':"")+"</div>"+"</div>";o.empty();var N=angular.element(x);var C=angular.element(T),k=C.eq(0).dropdown(),L=C.eq(1).find(":text"),A=C.eq(1).find("ul");var O=s.$new(true);B();k.on("click",function(e){if(O.disabled){return}if(!g){O.$apply(function(){b="";O.search=E()})}w=-1;L.focus()});k.on("keypress",function(e){if(!(e.altKey||e.ctrlKey)){k.click()}});L.on("keydown",function(e){if(!/(13|27|40|^9$)/.test(e.keyCode))return;e.preventDefault();e.stopPropagation();switch(e.keyCode){case 27:k.dropdown("toggle");break;case 13:H();break;case 40:P();break;case 9:k.dropdown("toggle");break}});A.on("keydown",function(e){if(!/(38|40)/.test(e.keyCode))return;e.preventDefault();e.stopPropagation();var t=A.find("li > a");if(!t.length)return;if(e.keyCode==38)w--;if(e.keyCode==40&&w<t.length-1)w++;if(w>=0){t.eq(w).focus()}else{w=-1;L.focus()}});t(N)(s);o.append(N);t(C)(O);o.append(C);a.$render=function(){n(M,50)};O.$watch(D,M);O.$watch(function(){return o.attr("disabled")},function(e){O.disabled=e});s.$watch(p,function(e){O[p]=e})}}}]);module.directive("stopPropagation",function(){return{restrict:"A",link:function(e,t,n,r){var i=n["stopPropagation"];t.bind(i,function(e){e.stopPropagation()})}}})